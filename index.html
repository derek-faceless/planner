<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–ú–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</title>
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogItCc0L7QuSDQv9C70LDQvdC40YDQvtCy0YnQuNC6IiwKICAic2hvcnRfbmFtZSI6ICLQn9C70LDQvdC40YDQvtCy0YnQuNC6IiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJ0aGVtZV9jb2xvciI6ICIjM2I4MmY2IiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxOTInIGhlaWdodD0nMTkyJyUzRSUzQ3JlY3Qgd2lkdGg9JzE5MicgaGVpZ2h0PScxOTInIGZpbGw9JyUyMzNiODJmNicvJTNFJTNDdGV4dCB4PSc1MCUyNScgeT0nNTAlMjUnIGZvbnQtc2l6ZT0nMTAwJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmaWxsPSclMjNmZmZmZmYnJTNF8J+ThSUzQy90ZXh0JTNFJTNDL3N2ZyUzRSIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyUzRSUzQ3JlY3Qgd2lkdGg9JzUxMicgaGVpZ2h0PSc1MTInIGZpbGw9JyUyMzNiODJmNicvJTNFJTNDdGV4dCB4PSc1MCUyNScgeT0nNTAlMjUnIGZvbnQtc2l6ZT0nMzAwJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmaWxsPSclMjNmZmZmZmYnJTNF8J+ThSUzQy90ZXh0JTNFJTNDL3N2ZyUzRSIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }
        .mobile-tap {
            -webkit-tap-highlight-color: transparent;
        }
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }
        }
        .icon-calendar::before { content: 'üìÖ'; }
        .icon-dumbbell::before { content: 'üèãÔ∏è'; }
        .icon-briefcase::before { content: 'üíº'; }
        .icon-home::before { content: 'üè†'; }
        .icon-book::before { content: 'üìö'; }
        .icon-moon::before { content: 'üåô'; }
        .icon-pill::before { content: 'üíä'; }
        .icon-check::before { content: '‚úì'; }
        .icon-plus::before { content: '+'; }
        .icon-clock::before { content: 'üïê'; }
        .icon-trend::before { content: 'üìä'; }
        .icon-alert::before { content: '‚ö†Ô∏è'; }
        .icon-chevron-up::before { content: '‚ñ≤'; }
        .icon-chevron-down::before { content: '‚ñº'; }
            button { min-height: 44px; }
    </style>
</head>
<body class="bg-gray-50 overflow-x-hidden">
    <div id="app"></div>

    <script>
        // Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:application/javascript;base64,' + btoa(`
                const CACHE_NAME = 'planner-v1';
                self.addEventListener('install', (e) => { self.skipWaiting(); });
                self.addEventListener('fetch', (e) => {
                    e.respondWith(caches.match(e.request).then(r => r || fetch(e.request)));
                });
            `)).catch(err => console.log('SW failed'));
        }

        const storage = {
            get: (key) => {
                try { return JSON.parse(localStorage.getItem(key)); } 
                catch { return null; }
            },
            set: (key, value) => localStorage.setItem(key, JSON.stringify(value))
        };

        class ScheduleApp {
            constructor() {
                this.state = this.state || {};
                this.state.mobileDay = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;

                this.state = {
                    currentWeek: 0,
                    schedule: storage.get('schedule') || {
                        0: { work: true, gym: true, repair: true },
                        1: { work: false, gym: false, repair: true },
                        2: { work: true, gym: true, repair: true },
                        3: { work: false, gym: false, repair: true },
                        4: { work: true, gym: true, repair: true },
                        5: { work: false, gym: false, repair: true },
                        6: { work: false, gym: true, repair: true }
                    },
                    tasks: storage.get('tasks') || {},
                    notes: storage.get('notes') || {},
                    completed: storage.get('completed') || {},
                    customEvents: storage.get('customEvents') || {},
                    supplementsTaken: storage.get('supplementsTaken') || {},
                    showStats: true,
                    showTasks: {},
                    showSupplementsModal: false
                };
                this.supplementsConfig = storage.get('supplementsConfig') || [
                    { id: 1, name: '–ê–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç—ã', icon: 'üíä', timing: 'wake', active: true },
                    { id: 2, name: '–ö—Ä–µ–∞—Ç–∏–Ω (—É—Ç—Ä–æ)', icon: 'üíä', timing: 'wake', active: true },
                    { id: 3, name: '–ú—É–ª—å—Ç–∏-–í–∏—Ç–∞–º–∏–Ω—ã', icon: 'üåü', timing: 'breakfast', active: true },
                    { id: 4, name: '–û–º–µ–≥–∞ 3', icon: 'üêü', timing: 'breakfast', active: true },
                    { id: 5, name: '–ë–µ—Ç–∞-–∞–ª–∞–Ω–∏–Ω', icon: '‚ö°', timing: 'pre-gym', gymOnly: true, active: true },
                    { id: 6, name: '–¶–∏—Ç—Ä—É–ª–∏–Ω', icon: '‚ö°', timing: 'pre-gym', gymOnly: true, active: true },
                    { id: 7, name: '–ö—Ä–µ–∞—Ç–∏–Ω (–ø–æ—Å–ª–µ –∑–∞–ª–∞)', icon: 'üíä', timing: 'post-gym', gymOnly: true, active: true },
                    { id: 8, name: '–ì–µ–π–Ω–µ—Ä (–æ–ø—Ü.)', icon: 'ü•§', timing: 'post-gym', gymOnly: true, optional: true, active: true },
                    { id: 9, name: '–ì–∞–±–∞', icon: 'üò¥', timing: 'sleep', active: true },
                    { id: 10, name: 'B-–∫–æ–º–ø–ª–µ–∫—Å', icon: 'üíä', timing: 'sleep', active: true }
                ];
            }

            saveState() {
                storage.set('schedule', this.state.schedule);
                storage.set('tasks', this.state.tasks);
                storage.set('notes', this.state.notes);
                storage.set('completed', this.state.completed);
                storage.set('customEvents', this.state.customEvents);
                storage.set('supplementsTaken', this.state.supplementsTaken);
                storage.set('supplementsConfig', this.supplementsConfig);
            }

            getWeekDays(weekOffset) {
                const days = ['–ü–ù', '–í–¢', '–°–†', '–ß–¢', '–ü–¢', '–°–ë', '–í–°'];
                const today = new Date();
                const monday = new Date(today);
                monday.setDate(today.getDate() - today.getDay() + 1 + (weekOffset * 7));
                
                return days.map((day, index) => {
                    const date = new Date(monday);
                    date.setDate(monday.getDate() + index);
                    return {
                        day,
                        date: \`\${date.getDate()}.\${date.getMonth() + 1}\`,
                        fullDate: date.toISOString().split('T')[0]
                    };
                });
            }

            getTimeSlots(dayIndex, isWorkDay, isGymDay, isRepairDay) {
                const slots = [];
                
                if (isWorkDay) {
                    slots.push(
                        { time: '06:00-06:20', activity: '–ü–æ–¥—ä–µ–º', icon: 'üåô', color: 'bg-blue-100', id: 'wake', supplements: ['–ê–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç—ã', '–ö—Ä–µ–∞—Ç–∏–Ω'] },
                        { time: '06:20-06:30', activity: '–°–±–æ—Ä—ã', icon: 'üè†', color: 'bg-blue-100', id: 'prepare' },
                        { time: '06:30-07:00', activity: '–î–æ—Ä–æ–≥–∞ –Ω–∞ —Ä–∞–±–æ—Ç—É', icon: 'üíº', color: 'bg-orange-100', id: 'commute-work' },
                        { time: '07:00-15:00', activity: '–†–∞–±–æ—Ç–∞', icon: 'üíº', color: 'bg-orange-200', id: 'work', supplements: ['–ú—É–ª—å—Ç–∏-–í–∏—Ç–∞–º–∏–Ω—ã', '–û–º–µ–≥–∞ 3'] },
                        { time: '15:00-15:30', activity: '–î–æ—Ä–æ–≥–∞ –¥–æ–º–æ–π', icon: 'üíº', color: 'bg-orange-100', id: 'commute-home' },
                        { time: '15:30-16:00', activity: '–û–±–µ–¥/–æ—Ç–¥—ã—Ö', icon: 'üè†', color: 'bg-green-100', id: 'lunch' }
                    );
                    
                    if (isRepairDay) {
                        slots.push({ time: '16:00-19:00', activity: '–†–µ–º–æ–Ω—Ç (3 —á–∞—Å–∞)', icon: 'üè†', color: 'bg-yellow-200', id: 'repair' });
                    } else {
                        slots.push({ time: '16:00-19:00', activity: '–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è', icon: 'üè†', color: 'bg-gray-100', id: 'free-afternoon' });
                    }
                } else {
                    slots.push(
                        { time: '06:00-09:00', activity: '–°–æ–Ω (–¥–æ–ø. 3 —á–∞—Å–∞)', icon: 'üåô', color: 'bg-indigo-100', id: 'extra-sleep' },
                        { time: '09:00-09:30', activity: '–ü–æ–¥—ä–µ–º –∏ —Å–±–æ—Ä—ã', icon: 'üåô', color: 'bg-blue-100', id: 'wake', supplements: ['–ê–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç—ã', '–ö—Ä–µ–∞—Ç–∏–Ω'] },
                        { time: '09:30-10:30', activity: '–ó–∞–≤—Ç—Ä–∞–∫/–æ—Ç–¥—ã—Ö', icon: 'üè†', color: 'bg-green-100', id: 'breakfast', supplements: ['–ú—É–ª—å—Ç–∏-–í–∏—Ç–∞–º–∏–Ω—ã', '–û–º–µ–≥–∞ 3'] }
                    );
                    
                    if (isRepairDay) {
                        slots.push(
                            { time: '10:30-13:30', activity: '–†–µ–º–æ–Ω—Ç (3 —á–∞—Å–∞)', icon: 'üè†', color: 'bg-yellow-200', id: 'repair-1' },
                            { time: '13:30-14:30', activity: '–û–±–µ–¥', icon: 'üè†', color: 'bg-green-100', id: 'lunch' },
                            { time: '14:30-18:30', activity: '–†–µ–º–æ–Ω—Ç (4 —á–∞—Å–∞)', icon: 'üè†', color: 'bg-yellow-200', id: 'repair-2' }
                        );
                    } else {
                        slots.push(
                            { time: '10:30-13:30', activity: '–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è', icon: 'üè†', color: 'bg-gray-100', id: 'free-morning' },
                            { time: '13:30-14:30', activity: '–û–±–µ–¥', icon: 'üè†', color: 'bg-green-100', id: 'lunch' },
                            { time: '14:30-18:30', activity: '–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è', icon: 'üè†', color: 'bg-gray-100', id: 'free-afternoon' }
                        );
                    }
                }

                if (isGymDay) {
                    slots.push(
                        { time: '19:00-19:30', activity: '–î–æ—Ä–æ–≥–∞ –≤ –∑–∞–ª', icon: 'üèãÔ∏è', color: 'bg-red-100', id: 'commute-gym', supplements: ['–ë–µ—Ç–∞-–∞–ª–∞–Ω–∏–Ω', '–¶–∏—Ç—Ä—É–ª–∏–Ω'] },
                        { time: '19:30-21:00', activity: '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞', icon: 'üèãÔ∏è', color: 'bg-red-200', id: 'gym' },
                        { time: '21:00-21:30', activity: '–î–æ—Ä–æ–≥–∞ –¥–æ–º–æ–π', icon: 'üèãÔ∏è', color: 'bg-red-100', id: 'commute-gym-back', supplements: ['–ö—Ä–µ–∞—Ç–∏–Ω', '–ì–µ–π–Ω–µ—Ä (–æ–ø—Ü.)'] },
                        { time: '21:30-22:30', activity: '–£–∂–∏–Ω/–¥—É—à', icon: 'üè†', color: 'bg-green-100', id: 'dinner' },
                        { time: '22:30-23:30', activity: '–û–Ω–ª–∞–π–Ω –∫—É—Ä—Å', icon: 'üìö', color: 'bg-purple-200', id: 'course' },
                        { time: '23:30-00:00', activity: '–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è', icon: 'üè†', color: 'bg-gray-100', id: 'free', supplements: ['–ì–∞–±–∞', 'B-–∫–æ–º–ø–ª–µ–∫—Å'] }
                    );
                } else {
                    if (isWorkDay) {
                        slots.push(
                            { time: '19:00-20:00', activity: '–£–∂–∏–Ω/–æ—Ç–¥—ã—Ö', icon: 'üè†', color: 'bg-green-100', id: 'dinner' },
                            { time: '20:00-22:00', activity: '–û–Ω–ª–∞–π–Ω –∫—É—Ä—Å (2 —á–∞—Å–∞)', icon: 'üìö', color: 'bg-purple-200', id: 'course' },
                            { time: '22:00-00:00', activity: '–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è', icon: 'üè†', color: 'bg-gray-100', id: 'free', supplements: ['–ì–∞–±–∞', 'B-–∫–æ–º–ø–ª–µ–∫—Å'] }
                        );
                    } else {
                        slots.push(
                            { time: '18:30-19:30', activity: '–£–∂–∏–Ω/–æ—Ç–¥—ã—Ö', icon: 'üè†', color: 'bg-green-100', id: 'dinner' },
                            { time: '19:30-21:30', activity: '–û–Ω–ª–∞–π–Ω –∫—É—Ä—Å (2 —á–∞—Å–∞)', icon: 'üìö', color: 'bg-purple-200', id: 'course' },
                            { time: '21:30-00:00', activity: '–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è', icon: 'üè†', color: 'bg-gray-100', id: 'free', supplements: ['–ì–∞–±–∞', 'B-–∫–æ–º–ø–ª–µ–∫—Å'] }
                        );
                    }
                }

                slots.push({ time: '00:00', activity: '–°–æ–Ω', icon: 'üåô', color: 'bg-indigo-200', id: 'sleep' });
                return slots;
            }

            
            isMobile() {
                return window.innerWidth < 640;
            }

            prevDay() {
                this.state.mobileDay = (this.state.mobileDay + 6) % 7;
                this.update();
            }

            nextDay() {
                this.state.mobileDay = (this.state.mobileDay + 1) % 7;
                this.update();
            }

            renderMobileDay(weekDays) {
                const i = this.state.mobileDay;
                const day = weekDays[i];
                const cfg = this.state.schedule[i];
                const slots = this.getTimeSlots(i, cfg.work, cfg.gym, cfg.repair);

                return `
                    <div class="space-y-3">
                        <div class="flex items-center justify-between mb-2">
                            <button onclick="app.prevDay()" class="px-3 py-2 bg-gray-200 rounded">‚Üê</button>
                            <div class="text-center">
                                <div class="text-lg font-bold">${day.day}</div>
                                <div class="text-sm text-gray-600">${day.date}</div>
                            </div>
                            <button onclick="app.nextDay()" class="px-3 py-2 bg-gray-200 rounded">‚Üí</button>
                        </div>

                        <div class="flex gap-2 justify-center">
                            ${['work','gym','repair'].map(type => `
                                <button onclick="app.toggle('${type}', ${i})"
                                    class="px-3 py-1 rounded text-xs
                                    ${cfg[type] ? 'bg-blue-500 text-white' : 'bg-gray-200'}">
                                    ${type === 'work' ? '–†–∞–±–æ—Ç–∞' : type === 'gym' ? '–ó–∞–ª' : '–†–µ–º–æ–Ω—Ç'}
                                </button>
                            `).join('')}
                        </div>

                        <div class="space-y-2">
                            ${slots.map(slot => `
                                <div class="p-3 rounded ${slot.color} flex gap-2">
                                    <div class="text-lg">${slot.icon}</div>
                                    <div>
                                        <div class="font-semibold text-sm">${slot.time}</div>
                                        <div class="text-sm">${slot.activity}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            render() {
                const weekDays = this.getWeekDays(this.state.currentWeek);
                
                return \`
                    <div class="max-w-7xl mx-auto p-4 sm:p-6 bg-white min-h-screen">
                        <div class="mb-6">
                            <div class="flex items-center justify-between mb-4">
                                <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 flex items-center gap-2">
                                    <span class="icon-calendar text-3xl"></span>
                                    –ú–æ–π —Ä–∞—Å–ø–æ—Ä—è–¥–æ–∫ –¥–Ω—è
                                </h1>
                                <div class="flex gap-2">
                                    <button onclick="app.showSupplements()" class="px-3 py-2 sm:px-4 bg-green-500 text-white rounded hover:bg-green-600 flex items-center gap-1 mobile-tap text-sm sm:text-base">
                                        <span class="icon-pill"></span>
                                        <span class="hidden sm:inline">–°–ø–æ—Ä—Ç–ø–∏—Ç</span>
                                    </button>
                                    <button onclick="app.prevWeek()" class="px-3 py-2 sm:px-4 bg-gray-200 rounded hover:bg-gray-300 mobile-tap text-sm sm:text-base">
                                        ‚Üê <span class="hidden sm:inline">–ü—Ä–µ–¥.</span>
                                    </button>
                                    <button onclick="app.nextWeek()" class="px-3 py-2 sm:px-4 bg-gray-200 rounded hover:bg-gray-300 mobile-tap text-sm sm:text-base">
                                        <span class="hidden sm:inline">–°–ª–µ–¥.</span> ‚Üí
                                    </button>
                                </div>
                            </div>
                            
                            \${this.renderStats(weekDays)}
                            \${this.renderWarnings()}
                            
                            <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mb-6 text-xs sm:text-sm">
                                <div class="flex items-center gap-2 p-2 sm:p-3 bg-orange-50 rounded">
                                    <span class="icon-briefcase text-base sm:text-xl text-orange-600"></span>
                                    <span class="font-medium">–†–∞–±–æ—Ç–∞ (2/2)</span>
                                </div>
                                <div class="flex items-center gap-2 p-2 sm:p-3 bg-red-50 rounded">
                                    <span class="icon-dumbbell text-base sm:text-xl text-red-600"></span>
                                    <span class="font-medium">–ó–∞–ª (1/1)</span>
                                </div>
                                <div class="flex items-center gap-2 p-2 sm:p-3 bg-yellow-50 rounded">
                                    <span class="icon-home text-base sm:text-xl text-yellow-600"></span>
                                    <span class="font-medium">–†–µ–º–æ–Ω—Ç</span>
                                </div>
                                <div class="flex items-center gap-2 p-2 sm:p-3 bg-purple-50 rounded">
                                    <span class="icon-book text-base sm:text-xl text-purple-600"></span>
                                    <span class="font-medium">–ö—É—Ä—Å (1-2—á)</span>
                                </div>
                            </div>
                        </div>

                        \${this.isMobile() ? this.renderMobileDay(weekDays) : this.renderScheduleTable(weekDays)}
                        
                        \${this.state.showSupplementsModal ? this.renderSupplementsModal() : ''}
                    </div>
                \`;
            }

            renderStats(weekDays) {
                let totalRepair = 0, totalGym = 0, totalCourse = 0, workDays = 0, totalSupp = 0, takenSupp = 0;
                
                Object.keys(this.state.schedule).forEach(i => {
                    const day = this.state.schedule[i];
                    if (day.work) {
                        workDays++;
                        if (day.repair) totalRepair += 3;
                        totalCourse += day.gym ? 1 : 2;
                    } else {
                        if (day.repair) totalRepair += 7;
                        totalCourse += 2;
                    }
                    if (day.gym) totalGym++;
                });

                weekDays.forEach((day, i) => {
                    const slots = this.getTimeSlots(i, this.state.schedule[i].work, this.state.schedule[i].gym, this.state.schedule[i].repair);
                    slots.forEach(slot => {
                        if (slot.supplements) {
                            slot.supplements.forEach((_, idx) => {
                                totalSupp++;
                                if (this.state.supplementsTaken[\`\${day.fullDate}-\${slot.id}-\${idx}\`]) takenSupp++;
                            });
                        }
                    });
                });

                const totalTasks = Object.values(this.state.tasks).reduce((sum, dayTasks) => sum + dayTasks.length, 0);
                const completedTasks = Object.values(this.state.tasks).reduce((sum, dayTasks) => 
                    sum + dayTasks.filter(t => t.completed).length, 0);

                return \`
                    <div class="mb-4">
                        <button onclick="app.toggleStats()" class="flex items-center gap-2 text-base sm:text-lg font-semibold mb-2 hover:text-blue-600 mobile-tap">
                            <span class="icon-trend"></span>
                            –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–µ–ª–∏
                            <span class="\${this.state.showStats ? 'icon-chevron-up' : 'icon-chevron-down'} text-xs"></span>
                        </button>
                        
                        \${this.state.showStats ? \`
                            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-2 sm:gap-3 text-xs sm:text-sm">
                                <div class="p-3 sm:p-4 bg-yellow-50 rounded border-2 border-yellow-200">
                                    <div class="text-xl sm:text-2xl font-bold text-yellow-700">\${totalRepair}—á</div>
                                    <div class="text-gray-600">–†–µ–º–æ–Ω—Ç</div>
                                </div>
                                <div class="p-3 sm:p-4 bg-red-50 rounded border-2 border-red-200">
                                    <div class="text-xl sm:text-2xl font-bold text-red-700">\${totalGym}</div>
                                    <div class="text-gray-600">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                                </div>
                                <div class="p-3 sm:p-4 bg-purple-50 rounded border-2 border-purple-200">
                                    <div class="text-xl sm:text-2xl font-bold text-purple-700">\${totalCourse}—á</div>
                                    <div class="text-gray-600">–û–±—É—á–µ–Ω–∏–µ</div>
                                </div>
                                <div class="p-3 sm:p-4 bg-orange-50 rounded border-2 border-orange-200">
                                    <div class="text-xl sm:text-2xl font-bold text-orange-700">\${workDays}</div>
                                    <div class="text-gray-600">–†–∞–±–æ—á–∏—Ö –¥–Ω–µ–π</div>
                                </div>
                                <div class="p-3 sm:p-4 bg-green-50 rounded border-2 border-green-200">
                                    <div class="text-xl sm:text-2xl font-bold text-green-700">\${completedTasks}/\${totalTasks}</div>
                                    <div class="text-gray-600">–ó–∞–¥–∞—á–∏</div>
                                </div>
                                <div class="p-3 sm:p-4 bg-teal-50 rounded border-2 border-teal-200">
                                    <div class="text-xl sm:text-2xl font-bold text-teal-700">\${takenSupp}/\${totalSupp}</div>
                                    <div class="text-gray-600">–°–ø–æ—Ä—Ç–ø–∏—Ç</div>
                                </div>
                            </div>
                        \` : ''}
                    </div>
                \`;
            }

            renderWarnings() {
                const gymCount = Object.values(this.state.schedule).filter(d => d.gym).length;
                let totalRepair = 0;
                Object.keys(this.state.schedule).forEach(i => {
                    const day = this.state.schedule[i];
                    if (day.repair) totalRepair += day.work ? 3 : 7;
                });
                
                const warnings = [];
                if (gymCount >= 5) warnings.push('‚ö†Ô∏è –ú–Ω–æ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ - –Ω–µ –∑–∞–±—ã–≤–∞–π –ø—Ä–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ!');
                if (totalRepair > 35) warnings.push('‚ö†Ô∏è –ú–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞ - –Ω–µ –∑–∞–±—ã–≤–∞–π –æ—Ç–¥—ã—Ö–∞—Ç—å!');
                
                if (warnings.length === 0) return '';
                
                return \`
                    <div class="mb-4 space-y-2">
                        \${warnings.map(w => \`
                            <div class="p-3 bg-amber-50 border border-amber-300 rounded flex items-center gap-2 text-sm">
                                <span class="icon-alert text-amber-600"></span>
                                <span class="text-amber-800">\${w}</span>
                            </div>
                        \`).join('')}
                    </div>
                \`;
            }

            renderScheduleTable(weekDays) {
                return \`
                    <div class="overflow-x-auto -mx-2 sm:mx-0">
                        <table class="w-full border-collapse text-xs">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border p-2 text-left font-semibold min-w-[80px] sm:min-w-[100px]">–í—Ä–µ–º—è</th>
                                    \${weekDays.map((day, i) => \`
                                        <th class="border p-2 sm:p-3 text-center min-w-[140px] sm:min-w-[160px]">
                                            <div class="font-bold text-base sm:text-lg">\${day.day}</div>
                                            <div class="text-xs sm:text-sm text-gray-600">\${day.date}</div>
                                            <div class="flex flex-wrap gap-1 justify-center mt-2">
                                                <button onclick="app.toggle('work', \${i})" class="px-2 py-1 text-[10px] sm:text-xs rounded mobile-tap \${this.state.schedule[i].work ? 'bg-orange-500 text-white' : 'bg-gray-200 text-gray-600'}">
                                                    –†–∞–±–æ—Ç–∞
                                                </button>
                                                <button onclick="app.toggle('gym', \${i})" class="px-2 py-1 text-[10px] sm:text-xs rounded mobile-tap \${this.state.schedule[i].gym ? 'bg-red-500 text-white' : 'bg-gray-200 text-gray-600'}">
                                                    –ó–∞–ª
                                                </button>
                                                <button onclick="app.toggle('repair', \${i})" class="px-2 py-1 text-[10px] sm:text-xs rounded mobile-tap \${this.state.schedule[i].repair ? 'bg-yellow-500 text-white' : 'bg-gray-200 text-gray-600'}">
                                                    –†–µ–º–æ–Ω—Ç
                                                </button>
                                            </div>
                                            <div class="mt-2 flex gap-1 justify-center">
                                                <button onclick="app.addTask(\${i}, '\${day.fullDate}')" class="px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 mobile-tap" title="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É">
                                                    <span class="icon-plus text-xs"></span>
                                                </button>
                                                <button onclick="app.addEvent(\${i}, '\${day.fullDate